input {
  http_poller {
    urls => {
      "elasticsearch_query" => {
        url => "https://localhost:9200/syslog-index/_search"
        method => "post"
        body => '{"query": {"match_all": {}}}' 
        headers => {
          "Content-Type" => "application/json" 
        }
        auth => {
          user => "elastic" 
          password => "8PSamhKm-Zvg5UwxvCld"
        }
      }
    }
    request_timeout => 60
    schedule => { cron => "* * * * *" } 
    codec => "json" 
  }
}

output {
  elasticsearch {
    hosts => "https://localhost:9200"
    user => "elastic"
    password => "8PSamhKm-Zvg5UwxvCld"
    index => "test-input-index"
    ssl_enabled => true
    ssl_certificate_authorities => '/home/federica/ELASTIC/ELASTIC-8.15/elasticsearch-8.15.2/config/certs/http_ca.crt'

  }
}

